# Mumbies Platform - Development Standards

## Project Overview
Mumbies is building the Amazon of natural pet products with a unique partner ecosystem. We're a consumer brand evolving into a retail platform. Quality and professionalism matter - this isn't a prototype, it's production code.

## Design Philosophy
- **Beautiful, not generic**: Every design should look premium and purposeful, not like a template
- **Production-ready**: All code must be deployment-ready, well-tested, and documented
- **Brand-aligned**: Natural, trustworthy aesthetic (think Thrive Market + Chewy)
- **User-first**: Prioritize usability and clarity over complexity

## Technical Stack (DO NOT DEVIATE)
- **Framework**: React 18 + TypeScript + Vite
- **Styling**: Tailwind CSS (utility-first, no custom CSS unless necessary)
- **Icons**: Lucide React ONLY (no other icon libraries)
- **UI Components**: Shadcn/ui (copy-paste components, not npm packages)
- **Database**: Supabase (PostgreSQL + Auth + RLS)
- **State**: React Context API (no Redux unless explicitly requested)
- **Routing**: React Router v6
- **Deployment**: Vercel (auto-deploy from GitHub)

## Code Quality Standards

### DO:
- ‚úÖ Write TypeScript with proper types (no `any` types)
- ‚úÖ Use descriptive variable/function names (`fetchPartnerLeads` not `getData`)
- ‚úÖ Add console.logs for debugging during development
- ‚úÖ Include error handling for all async operations
- ‚úÖ Write comments explaining WHY, not WHAT
- ‚úÖ Use semantic HTML (proper heading hierarchy, ARIA labels)
- ‚úÖ Make responsive designs (mobile-first approach)
- ‚úÖ Test queries and show me the results before claiming success
- ‚úÖ Verify changes in the browser/deployed site before saying "done"

### DON'T:
- ‚ùå Install unnecessary packages without asking first
- ‚ùå Use inline styles (use Tailwind classes)
- ‚ùå Create files in wrong directories
- ‚ùå Make database changes without migration files
- ‚ùå Claim something is "fixed" without visual proof
- ‚ùå Use generic placeholder content (make it realistic)
- ‚ùå Ignore accessibility (proper labels, keyboard navigation, screen readers)

## Design Standards

### Visual Design:
- **Colors**: Green primary (#16a34a), natural earth tones, high contrast
- **Typography**: Clear hierarchy, readable sizes (min 16px body text)
- **Spacing**: Generous whitespace, consistent padding/margins
- **Components**: Rounded corners (rounded-lg), subtle shadows
- **Forms**: Clear labels, helpful error messages, loading states
- **Empty States**: Encouraging, not just "No data" - guide users on what to do next

### UX Principles:
- Show loading states for all async operations
- Provide feedback for user actions (toasts, success messages)
- Use progressive disclosure (don't overwhelm with all features at once)
- Include helpful tooltips and contextual help
- Make CTAs obvious and actionable
- Handle errors gracefully with recovery options

## File Structure Rules
```
apps/
  admin/               ‚Üê Admin portal code
  partner/             ‚Üê Partner portal code
supabase/
  migrations/          ‚Üê ALL database changes go here
src/
  components/          ‚Üê Reusable UI components
    partner/           ‚Üê Partner-specific components
  contexts/            ‚Üê React Context providers
  pages/               ‚Üê Route pages
  lib/                 ‚Üê Utilities, config, helpers
```

**CRITICAL**: 
- Partner portal changes go in `apps/partner/`
- Admin portal changes go in `apps/admin/`
- Never create duplicate files in wrong locations
- Use existing components before creating new ones

## Database & API Rules

### Supabase Queries:
```typescript
// GOOD: Includes error handling, logging, proper typing
const { data, error } = await supabase
  .from('partner_leads')
  .select('id, email, status, expires_at')
  .eq('partner_id', partnerId)
  .order('expires_at', { ascending: true });

if (error) {
  console.error('Failed to fetch leads:', error);
  // Handle error appropriately
  return;
}

console.log('Fetched leads:', data);
```

// BAD: No error handling, missing fields, no logging
```typescript
const { data } = await supabase
  .from('partner_leads')
  .select('*')
  .eq('partner_id', partnerId);
```

### Always Include:
- ‚úÖ Proper SELECT fields (never use `*` without reason)
- ‚úÖ Error handling with user-friendly messages
- ‚úÖ Loading states
- ‚úÖ Console logs for debugging (remove before production)
- ‚úÖ Type definitions matching database schema

## Testing & Verification

### Before Saying "Done":
1. **Show me the console logs** - What data was returned?
2. **Show me the browser** - What does the user see?
3. **Show me the git diff** - What actually changed?
4. **Verify the deployment** - Is it live on the URL?

### For Database Changes:
1. **Run the query** in Supabase SQL Editor first
2. **Show me the results** - Does data exist?
3. **Check RLS policies** - Can the user access it?
4. **Test the frontend** - Does it display correctly?

## Common Mistakes to Avoid

1. **Working in isolated sandbox**: If changes don't appear on live site, you're not connected to the actual repo
2. **Forgetting `status` field**: Always include `status` in nonprofit queries due to RLS policies
3. **Not checking deployed site**: Local/sandbox fixes don't automatically deploy
4. **Using wrong column names**: Check database schema before writing queries
5. **Claiming success prematurely**: Verify in browser before confirming fix

## Communication Standards

### When Reporting Progress:
- ‚úÖ "I changed line 105 in PartnerDashboardPage.tsx: added 'status' to SELECT query. Here's the diff: [show actual code]"
- ‚ùå "I fixed the issue" (without proof)

### When Encountering Issues:
- ‚úÖ "The query returned 0 results. Here's what I tried: [query]. Here's the error: [actual error message]"
- ‚ùå "It's not working" (without details)

### When Making Suggestions:
- ‚úÖ "Option A: Quick fix (add one field). Option B: Refactor (better long-term but takes 2 hours)"
- ‚ùå "You should rebuild everything" (without context)

## Current Project Status

**What's Built:**
- ‚úÖ Partner Portal (7 tabs: Overview, Rewards, Giveaways, Leads, Referrals, Products, Settings)
- ‚úÖ Admin Portal (Partner applications, leads management)
- ‚úÖ Database (26 tables, full schema)
- ‚úÖ Authentication (Supabase Auth)
- üöß Shopify integration (webhooks connected, product sync in progress)

**Known Issues:**
- Partner portal deployed at: partners.staging.mumbies.com
- Admin portal deployed at: admin.mumbies.com
- Database: Supabase production (zsrkexpnfvivrtgzmgdw.supabase.co)

**Active Demo Requirements:**
- Partner login working ‚úÖ
- Leads tab showing 26 leads (CRITICAL FOR DEMO)
- Gift incentive sending functionality
- Commission tracking visible

## Emergency Protocols

**If Something Breaks Before Demo:**
1. Don't refactor - do minimum viable fix
2. Show proof it works on live URL
3. Test with actual partner login credentials
4. Verify data appears in UI, not just database

**If Stuck:**
1. Show me the exact error message
2. Show me the query you ran
3. Show me what the database returned
4. Show me what the user sees
5. Then we debug together

## Context Preservation

**Important URLs:**
- Production site: mumbies.com (Shopify)
- Partner portal: partners.staging.mumbies.com
- Admin portal: admin.mumbies.com
- Supabase: https://zsrkexpnfvivrtgzmgdw.supabase.co

**Key People:**
- Wisconsin Humane Society: Main demo partner
- Database has: 26 leads, 65 total partner leads
- Demo timing: Time-sensitive, need working features

**Business Model:**
- Partners earn 5% commission on attributed sales
- 90-day attribution window
- Gift incentives: Partners send $5-$15 to convert leads
- Commissions stored as "Mumbies Cash" balance